#Here we are performing different Built In operations on Strings:

LPAD,RPAD - It is used to fill up the memory spaces for remaining characters 

SELECT title, RPAD(title, 20, '*'),25,'*') AS Right_padded
FROM sakila.film
LIMIT 5;  ------- Padding is added Right side of the title

SELECT title, LPAD(title, 20, '*') AS left_padded
FROM sakila.film
LIMIT 5; ------- Padding is added Left side of the title

------------------------------------------------------------------------------------------------------------------------------
#Introduction to Substring function:

SELECT title, SUBSTRING(title, 1,9)  AS short_title 
FROM sakila.film; ----- Title --- start from 1st char upto 9 char 

------------------------------------------------------------------------------------------------------------------------------
#concatination : Adding of two strings

SELECT CONCAT(first_name, '.', last_name) AS full_name 
FROM sakila.customer;------It displays full name as first_name.last_name

-------------------------------------------------------------------------------------------------------------------------------
# Reverse: It is used to reverse text

SELECT title, REVERSE(title) AS reversed_title
FROM sakila.film
LIMIT 5;------------- reverse_title displays reverse text

----------------------------------------------------------------------------------------------------------------------------------
#length: It displays num of char in the string  

SELECT title, LENGTH(title) AS title_length 
FROM sakila.film
WHERE LENGTH(title) =8;

------------------------------------------------------------------------------------------------------------------------------------
#substring with locate: Locate is to find position 
#LOCATE('@', email): Finds the position of @ in the email string.
#SUBSTRING(email, LOCATE('@', email) + 1): Extracts the string after @

SELECT email,
       SUBSTRING(email, LOCATE('@', email) +1) AS domain
FROM sakila.customer; -----------LOCATE('@', email) finds position of '@' in the email
----SUBSTRING(email, LOCATE('@', email) + 1) here +1 means returns everything after '@'


SELECT 
  email,
  substring_index(SUBSTRING(email, LOCATE('@', email) + 1), '.', -1) AS domain
FROM 
  sakila.customer;------------ return org from 'MARY.SMITH@sakilacustomer.org'

#substring_index
select substring_index(email,'@', 1) from sakila.customer;----------- return 'MARY.SMITH'

---------------------------------------------------------------------------------------------------------------------------------------
---UPPER / LOWER :
---UPPER(title) → converts the title to all uppercase letters.
---lower(title) → converts the title to all lowercase letters.
---LIKE '%LOVELY%' → finds titles that contain the word 'LOVELY' anywhere. 
---LIKE '%MAN' → finds titles that end with 'MAN'.

SELECT title, UPPER(title),lower(title)
FROM sakila.film
WHERE UPPER(title) LIKE '%LOVELY%' or UPPER(title) LIKE '%MAN';

select title, lower(title) as lower_titles
FROM sakila.film;

---------------------------------------------------------------------------------------------------------------------------------------

SELECT LEFT(title, 2) AS first_letter, right(title,3) as last_letter,  COUNT(*) AS film_count
FROM sakila.film
GROUP BY LEFT(title, 2), right(title,3)
ORDER BY film_count DESC;

----------------------------------------------------------------------------------------------------------------------------------------

SELECT last_name,
       CASE 
           WHEN LEFT(last_name, 1) BETWEEN 'A' AND 'M' THEN 'Group A-M'
           WHEN LEFT(last_name, 1) BETWEEN 'N' AND 'Z' THEN 'Group N-Z'
           ELSE 'Other'
       END AS group_label
FROM sakila.customer;

--------------------------------------------------------------------------------------------------------------------------------------
# returns a new column called cleaned_title capital letter 'A' in the title is replaced by 'x'.
SELECT title, REPLACE(title, 'A', 'x') AS cleaned_title
FROM sakila.film
WHERE title LIKE '%' '%';
 
-------------------------------------------------------------------------------------------------------------------------------------
#not contains 3 consecutive vowels 

SELECT customer_id, last_name
FROM sakila.customer
WHERE last_name REGEXP '[^aeiouAEIOU]{3}'; 

--$ ends with vowel

SELECT lower(title)
FROM sakila.film
WHERE title REGEXP '[aeiouAEIOU]$';


select title, right(title,2)
FROM sakila.film
WHERE title REGEXP '[eE]$';

-- count 

select right(title,1), count(*)
FROM sakila.film
WHERE title REGEXP '[aeiouAEIOU]$' 
group by right(title,1)
;

SELECT title AS ending, right(title,1)
FROM sakila.film
WHERE title REGEXP '[Ee]$';


--------------------------------------------------------------------------------------------------------------------------------------
#math 

SELECT title, rental_rate, rental_rate ^ 3 AS double_rate   
FROM sakila.film;


SELECT customer_id,
       COUNT(payment_id) AS payments,
       SUM(amount) AS total_paid,
       SUM(amount) / COUNT(payment_id) AS avg_payment
       
FROM sakila.payment
GROUP BY customer_id;
----------------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE sakila.film
ADD COLUMN cost_efficiency_dup1 DECIMAL(6,2);


SET SQL_SAFE_UPDATES = 0;

UPDATE sakila.film
SET cost_efficiency_dup1 = rental_duration * 2
WHERE length IS NOT NULL;

-----------------------------------------------------------------------------------------------------------------------------------

SELECT customer_id, (RAND() * 100), FLOOR(RAND() * 100) AS random_score
FROM sakila.customer
LIMIT 5; -----Random number

--------------------------------------------------------------------------------------------------------------------------------------

SELECT film_id,rental_duration, POWER(rental_duration, 2) AS squared_duration
FROM sakila.film
LIMIT 5; ------Power

--------------------------------------------------------------------------------------------------------------------------------------

SELECT film_id,length, MOD(length, 60) AS minutes_over_hour
FROM sakila.film;--------Remainder
---------------------------------------------------------------------------------------------------------------------------------------

SELECT rental_rate, CEIL(rental_rate) AS ceil_value, FLOOR(rental_rate) AS floor_value
FROM sakila.film;---------Round off to the nearest value (4.00 -- 5)
-------------------------------------------------------------------------------------------------------------------------------

SELECT rental_rate, ROUND(replacement_cost / rental_rate, 0),ROUND(replacement_cost / rental_rate, 1) AS ratio
FROM sakila.film;-------Round (21.2 --- 21)

---------------------------------
#date diff 

SELECT rental_id, return_date,rental_date, DATEDIFF(return_date, rental_date) AS days_rented
FROM sakila.rental
WHERE return_date IS NOT NULL;

#date time 

select last_update,dayname(last_update),monthname(last_update) from sakila.film;

SELECT 
    rental_date, year(rental_date)
FROM
   sakila.rental;


SELECT payment_date FROM sakila.payment;

SELECT payment_date, date(payment_date) AS pay_date, SUM(amount) AS total_paid
FROM sakila.payment
GROUP BY DATE(payment_date),payment_date
ORDER BY pay_date DESC;

#Find Customers Who Paid in the Last 24 Hours

select * from sakila.payment;

SELECT customer_id, amount, payment_date
FROM sakila.payment
WHERE payment_date >= NOW() - INTERVAL 1 DAY;

select max(payment_date) FROM sakila.payment;

SELECT customer_id, amount, payment_date
FROM sakila.payment
WHERE payment_date >= (
    SELECT MAX(payment_date) - INTERVAL 10 day
    FROM sakila.payment
);

select now()  - INTERVAL 1 DAY as yesterday;


SELECT CONCAT('Today is: ', CURDATE()) AS message;
SELECT CONCAT('Today is: ', now()) AS message;

SELECT NOW(), CURDATE(), CURRENT_TIME;
